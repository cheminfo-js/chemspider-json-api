(function(b,c){'object'==typeof exports&&'object'==typeof module?module.exports=c():'function'==typeof define&&define.amd?define([],c):'object'==typeof exports?exports.chemspiderJsonApi=c():b.chemspiderJsonApi=c()})(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var f=c[d]={exports:{},id:d,loaded:!1};return a[d].call(f.exports,f,f.exports,b),f.loaded=!0,f.exports}var c={};return b.m=a,b.c=c,b.p='',b(0)}([function(a,b,c){'use strict';function d(k,l){return new Promise(function(m){setTimeout(function(){m(l)},k)})}function f(k){return Object.prototype.toString.call(k).slice(8,-1)}function g(k,l,m){var o=!1;m||(o=!0,m=j.chemspiderUrl+('?op='+k));var p=f(l);if('Object'===p){var q=Object.keys(l);for(var r=0;r<q.length;r++)m=o?g(q[r],l[q[r]],m):g(k+'.'+q[r],l[q[r]],m)}else if('Array'===p)for(var r=0;r<l.length;r++)m=m+('&'+k+'['+r+']='+l[r]);else m=m+('&'+k+'='+l);return m}var h=c(1),j=c(6);b=a.exports={query:function(l,m){if(!l)throw new Error('Operation paramater is mandatory');m=Object.assign({},m);var o=g(l,m);return h.get(o).then(function(p){return p.text})},queryWithRid:function(l,m){function o(q){return p++,10===p?Promise.reject(q):d(100).then(function(){return b.queryJSON(l,m)}).then(null,o)}var p=0;return b.queryJSON(l,m).then(null,o)},queryJSON:function(l,m){return b.query(l,m).then(function(o){return JSON.parse(o)})},search:function(l){l=l||{};var m=l.searchMethod||'SimpleSearch',o=l.resultMethod||'GetSearchResultAsCompounds',p=l.searchOptions||{},q=l.resultOptions||{};return j.searchMethods.includes(m)?j.resultMethods.includes(o)?b.query(m,p).then(function(r){return b.queryWithRid(o,Object.assign({},q,{rid:r}))}):Promise.reject(new Error('Invalid result method')):Promise.reject(new Error('Invalid search method'))}}},function(a,b,c){function d(){}function f(A){if(!w(A))return A;var B=[];for(var C in A)g(B,C,A[C]);return B.join('&')}function g(A,B,C){if(null==C)null===C&&A.push(encodeURIComponent(B));else if(Array.isArray(C))C.forEach(function(E){g(A,B,E)});else if(w(C))for(var D in C)g(A,B+'['+D+']',C[D]);else A.push(encodeURIComponent(B)+'='+encodeURIComponent(C))}function h(A){var D,E,B={},C=A.split('&');for(var F=0,G=C.length;F<G;++F)D=C[F],E=D.indexOf('='),-1==E?B[decodeURIComponent(D)]='':B[decodeURIComponent(D.slice(0,E))]=decodeURIComponent(D.slice(E+1));return B}function j(A){var D,E,F,G,B=A.split(/\r?\n/),C={};B.pop();for(var H=0,I=B.length;H<I;++H)E=B[H],D=E.indexOf(':'),F=E.slice(0,D).toLowerCase(),G=y(E.slice(D+1)),C[F]=G;return C}function k(A){return /[\/+]json\b/.test(A)}function l(A){return A.split(/ *; */).shift()}function m(A){return A.split(/ *; */).reduce(function(B,C){var D=C.split(/ *= */),E=D.shift(),F=D.shift();return E&&F&&(B[E]=F),B},{})}function o(A,B){B=B||{},this.req=A,this.xhr=this.req.xhr,this.text='HEAD'!=this.req.method&&(''===this.xhr.responseType||'text'===this.xhr.responseType)||'undefined'==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=j(this.xhr.getAllResponseHeaders()),this.header['content-type']=this.xhr.getResponseHeader('content-type'),this._setHeaderProperties(this.header),this.body='HEAD'==this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function p(A,B){var C=this;this._query=this._query||[],this.method=A,this.url=B,this.header={},this._header={},this.on('end',function(){var D=null,E=null;try{E=new o(C)}catch(G){return D=new Error('Parser is unable to parse the response'),D.parse=!0,D.original=G,D.rawResponse=C.xhr&&C.xhr.responseText?C.xhr.responseText:null,D.statusCode=C.xhr&&C.xhr.status?C.xhr.status:null,C.callback(D)}C.emit('response',E);var F;try{(200>E.status||300<=E.status)&&(F=new Error(E.statusText||'Unsuccessful HTTP response'),F.original=D,F.response=E,F.status=E.status)}catch(G){F=G}F?C.callback(F,E):C.callback(null,E)})}function q(A,B){var C=x('DELETE',A);return B&&C.end(B),C}var r;'undefined'==typeof window?'undefined'==typeof self?(console.warn('Using browser-only version of superagent in non-browser environment'),r=this):r=self:r=window;var t=c(2),u=c(3),w=c(4),x=a.exports=c(5).bind(null,p);x.getXHR=function(){if(r.XMLHttpRequest&&(!r.location||'file:'!=r.location.protocol||!r.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject('Microsoft.XMLHTTP')}catch(A){}try{return new ActiveXObject('Msxml2.XMLHTTP.6.0')}catch(A){}try{return new ActiveXObject('Msxml2.XMLHTTP.3.0')}catch(A){}try{return new ActiveXObject('Msxml2.XMLHTTP')}catch(A){}throw Error('Browser-only verison of superagent could not find XHR')};var y=function(A){return A.trim()};for(var z in x.serializeObject=f,x.parseString=h,x.types={html:'text/html',json:'application/json',xml:'application/xml',urlencoded:'application/x-www-form-urlencoded',form:'application/x-www-form-urlencoded','form-data':'application/x-www-form-urlencoded'},x.serialize={'application/x-www-form-urlencoded':f,'application/json':JSON.stringify},x.parse={'application/x-www-form-urlencoded':h,'application/json':JSON.parse},(o.prototype.get=function(A){return this.header[A.toLowerCase()]},o.prototype._setHeaderProperties=function(){var A=this.header['content-type']||'';this.type=l(A);var B=m(A);for(var C in B)this[C]=B[C]},o.prototype._parseBody=function(A){var B=x.parse[this.type];return!B&&k(this.type)&&(B=x.parse['application/json']),B&&A&&(A.length||A instanceof Object)?B(A):null},o.prototype._setStatusProperties=function(A){1223===A&&(A=204);var B=0|A/100;this.status=this.statusCode=A,this.statusType=B,this.info=1==B,this.ok=2==B,this.clientError=4==B,this.serverError=5==B,this.error=(4==B||5==B)&&this.toError(),this.accepted=202==A,this.noContent=204==A,this.badRequest=400==A,this.unauthorized=401==A,this.notAcceptable=406==A,this.notFound=404==A,this.forbidden=403==A},o.prototype.toError=function(){var A=this.req,B=A.method,C=A.url,D='cannot '+B+' '+C+' ('+this.status+')',E=new Error(D);return E.status=this.status,E.method=B,E.url=C,E},x.Response=o,t(p.prototype),u))p.prototype[z]=u[z];p.prototype.type=function(A){return this.set('Content-Type',x.types[A]||A),this},p.prototype.responseType=function(A){return this._responseType=A,this},p.prototype.accept=function(A){return this.set('Accept',x.types[A]||A),this},p.prototype.auth=function(A,B,C){switch(C||(C={type:'basic'}),C.type){case'basic':var D=btoa(A+':'+B);this.set('Authorization','Basic '+D);break;case'auto':this.username=A,this.password=B;}return this},p.prototype.query=function(A){return'string'!=typeof A&&(A=f(A)),A&&this._query.push(A),this},p.prototype.attach=function(A,B,C){return this._getFormData().append(A,B,C||B.name),this},p.prototype._getFormData=function(){return this._formData||(this._formData=new r.FormData),this._formData},p.prototype.callback=function(A,B){var C=this._callback;this.clearTimeout(),C(A,B)},p.prototype.crossDomainError=function(){var A=new Error('Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.');A.crossDomain=!0,A.status=this.status,A.method=this.method,A.url=this.url,this.callback(A)},p.prototype._timeoutError=function(){var A=this._timeout,B=new Error('timeout of '+A+'ms exceeded');B.timeout=A,this.callback(B)},p.prototype._appendQueryString=function(){var A=this._query.join('&');A&&(this.url+=~this.url.indexOf('?')?'&'+A:'?'+A)},p.prototype.end=function(A){var B=this,C=this.xhr=x.getXHR(),D=this._timeout,E=this._formData||this._data;this._callback=A||d,C.onreadystatechange=function(){if(4==C.readyState){var J;try{J=C.status}catch(L){J=0}if(0==J)return B.timedout?B._timeoutError():B._aborted?void 0:B.crossDomainError();B.emit('end')}};var F=function(J,K){0<K.total&&(K.percent=100*(K.loaded/K.total)),K.direction=J,B.emit('progress',K)};if(this.hasListeners('progress'))try{C.onprogress=F.bind(null,'download'),C.upload&&(C.upload.onprogress=F.bind(null,'upload'))}catch(J){}if(D&&!this._timer&&(this._timer=setTimeout(function(){B.timedout=!0,B.abort()},D)),this._appendQueryString(),this.username&&this.password?C.open(this.method,this.url,!0,this.username,this.password):C.open(this.method,this.url,!0),this._withCredentials&&(C.withCredentials=!0),'GET'!=this.method&&'HEAD'!=this.method&&'string'!=typeof E&&!this._isHost(E)){var G=this._header['content-type'],H=this._serializer||x.serialize[G?G.split(';')[0]:''];!H&&k(G)&&(H=x.serialize['application/json']),H&&(E=H(E))}for(var I in this.header)null!=this.header[I]&&C.setRequestHeader(I,this.header[I]);return this._responseType&&(C.responseType=this._responseType),this.emit('request',this),C.send('undefined'==typeof E?null:E),this},x.Request=p,x.get=function(A,B,C){var D=x('GET',A);return'function'==typeof B&&(C=B,B=null),B&&D.query(B),C&&D.end(C),D},x.head=function(A,B,C){var D=x('HEAD',A);return'function'==typeof B&&(C=B,B=null),B&&D.send(B),C&&D.end(C),D},x.options=function(A,B,C){var D=x('OPTIONS',A);return'function'==typeof B&&(C=B,B=null),B&&D.send(B),C&&D.end(C),D},x.del=q,x['delete']=q,x.patch=function(A,B,C){var D=x('PATCH',A);return'function'==typeof B&&(C=B,B=null),B&&D.send(B),C&&D.end(C),D},x.post=function(A,B,C){var D=x('POST',A);return'function'==typeof B&&(C=B,B=null),B&&D.send(B),C&&D.end(C),D},x.put=function(A,B,C){var D=x('PUT',A);return'function'==typeof B&&(C=B,B=null),B&&D.send(B),C&&D.end(C),D}},function(a){function b(d){if(d)return c(d)}function c(d){for(var f in b.prototype)d[f]=b.prototype[f];return d}a.exports=b;b.prototype.on=b.prototype.addEventListener=function(d,f){return this._callbacks=this._callbacks||{},(this._callbacks['$'+d]=this._callbacks['$'+d]||[]).push(f),this},b.prototype.once=function(d,f){function g(){this.off(d,g),f.apply(this,arguments)}return g.fn=f,this.on(d,g),this},b.prototype.off=b.prototype.removeListener=b.prototype.removeAllListeners=b.prototype.removeEventListener=function(d,f){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var g=this._callbacks['$'+d];if(!g)return this;if(1==arguments.length)return delete this._callbacks['$'+d],this;var h;for(var j=0;j<g.length;j++)if(h=g[j],h===f||h.fn===f){g.splice(j,1);break}return this},b.prototype.emit=function(d){this._callbacks=this._callbacks||{};var f=[].slice.call(arguments,1),g=this._callbacks['$'+d];if(g){g=g.slice(0);for(var h=0,j=g.length;h<j;++h)g[h].apply(this,f)}return this},b.prototype.listeners=function(d){return this._callbacks=this._callbacks||{},this._callbacks['$'+d]||[]},b.prototype.hasListeners=function(d){return!!this.listeners(d).length}},function(a,b,c){var d=c(4);b.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},b.parse=function(g){return this._parser=g,this},b.serialize=function(g){return this._serializer=g,this},b.timeout=function(g){return this._timeout=g,this},b.then=function(g,h){if(!this._fullfilledPromise){var j=this;this._fullfilledPromise=new Promise(function(k,l){j.end(function(m,o){m?l(m):k(o)})})}return this._fullfilledPromise.then(g,h)},b.catch=function(f){return this.then(void 0,f)},b.use=function(g){return g(this),this},b.get=function(f){return this._header[f.toLowerCase()]},b.getHeader=b.get,b.set=function(f,g){if(d(f)){for(var h in f)this.set(h,f[h]);return this}return this._header[f.toLowerCase()]=g,this.header[f]=g,this},b.unset=function(f){return delete this._header[f.toLowerCase()],delete this.header[f],this},b.field=function(f,g){if(null===f||void 0===f)throw new Error('.field(name, val) name can not be empty');if(d(f)){for(var h in f)this.field(h,f[h]);return this}if(null===g||void 0===g)throw new Error('.field(name, val) val can not be empty');return this._getFormData().append(f,g),this},b.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit('abort'),this)},b.withCredentials=function(){return this._withCredentials=!0,this},b.redirects=function(f){return this._maxRedirects=f,this},b.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},b._isHost=function(g){var h={}.toString.call(g);return'[object File]'===h||'[object Blob]'===h||'[object FormData]'===h},b.send=function(f){var g=d(f),h=this._header['content-type'];if(g&&d(this._data))for(var j in f)this._data[j]=f[j];else'string'==typeof f?(h||this.type('form'),h=this._header['content-type'],this._data='application/x-www-form-urlencoded'==h?this._data?this._data+'&'+f:f:(this._data||'')+f):this._data=f;return!g||this._isHost(f)?this:(h||this.type('json'),this)}},function(a){a.exports=function(c){return null!==c&&'object'==typeof c}},function(a){a.exports=function(c,d,f){return'function'==typeof f?new c('GET',d).end(f):2==arguments.length?new c('GET',d):new c(d,f)}},function(a,b){'use strict';b.searchMethods=['SimpleSearch','ExactStructureSearch','SubstructureSearch','SimilaritySearch','IntrinsicPropertiesSearch','DataSourceSearch','ElementsSearch','PredictedPropertiesSearch','AdvancedSearch'],b.resultMethods=['GetSearchResult','GetSearchResultWithRelevance','GetSearchResultAsCompounds','GetSearchResultAsSdf'],b.chemspiderUrl='https://www.cheminfo.org/chemspider/JSON.ashx'}])});
//# sourceMappingURL=chemspider-json-api.min.js.map